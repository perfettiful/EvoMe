<!DOCTYPE html>
<html >
  <head>
    <meta charset="UTF-8">
    <title>EvoMe </title>
        <link rel="stylesheet" href="css/style.css">
  </head>
  <body>
    <div id="container">
  <input type="file" id="files" name="files[]" multiple />
  <output id="list"></output>
  <canvas id="c"></canvas>
  <script>
    function handleFileSelect(evt) {
      var files = evt.target.files; // FileList object

      // Loop through the FileList and render image files as thumbnails.
      for (var i = 0, f; f = files[i]; i++) {

        // Only process image files.
        if (!f.type.match('image.*')) {
          continue;
        }

        var reader = new FileReader();

        // Closure to capture the file information.
        reader.onload = (function(theFile) {
          return function(e) {
            // Render thumbnail.
            var span = document.createElement('span');
            span.innerHTML = ['<img id="target" alt="" src="', e.target.result,
              '" title="', escape(theFile.name), '"/>'
            ].join('');
            document.getElementById('list').insertBefore(span, null);
          };
        })(f);

        // Read in the image file as a data URL.
        reader.readAsDataURL(f);
      }
    }

    document.getElementById('files').addEventListener('change', handleFileSelect, false);
  </script>

  <div id="controls">
    <div class="info">
      <table>
        <tr>
          <td>FITNESS:</td>
          <td><span id="fitness">0</span></td>
        </tr>
        <tr>
          <td>GENERATION:</td>
          <td><span id="generation">0</span></td>
        </tr>
        <tr>
          <td>POLYGONS:</td>
          <td><span id="polygons">0</span></td>
        </tr>
      </table>
    </div>
    <br/>
    <ul>
      <li><a href="javascript:void(0);" id="start">Start</a></li>
      <li><a href="javascript:void(0);" id="stop">Stop</a></li>
      <li><a href="javascript:void(0);" id="reset">Reset</a></li>
    </ul>
  </div>
  <div id="display"></div>
</div>
<script type="text/javascript">
  var fitOutput = document.getElementById('fitness'),
    genOutput = document.getElementById('generation'),
    polyOutput = document.getElementById('polygons');
  //===================================  
  var displayEvolution = function(evo, startTime) {
    var d = document.createElement('div'),
      c = document.createElement('canvas'),
      display = document.getElementById('display');

    c.width = evoLisa.t.width;
    c.height = evoLisa.t.height;
    c.style.width = c.width * 3 / 5 + "px";
    c.style.height = c.height * 3 / 5 + "px";
    evo.draw(c);
    d.className = "container";
    var gen = evoLisa.generation,
      fit = evoLisa.dna.fit,
      timeTaken = new Date().getTime() - startTime;
    d.innerHTML = "<div class='info'>g: " + gen + "<br/>f: " + fit + "<br />t: " + timeTaken + "</div>";
    d.appendChild(c);
    display.appendChild(d);
  };

  var go = function() {
    var t = document.getElementById('target'),
      c = document.getElementById('c'),
      evoLisa = new EvoLisa(t, c);
    return evoLisa;
  }

  var evoLisa,
    start = document.getElementById('start'),
    stop = document.getElementById('stop'),
    reset = document.getElementById('reset');

  // set up our buttons
  start.onclick = function() {
    if (typeof evoLisa === "undefined")
      evoLisa = go();

    var startTime = new Date().getTime();

    evoLisa.start(function() {
      // update generation
      genOutput.innerHTML = evoLisa.generation;
      fitOutput.innerHTML = evoLisa.dna.fit;
      polyOutput.innerHTML = evoLisa.dna.dna.length;
      // shall we display another snapshot?
      if (evoLisa.generation % 500 == 0) {
        displayEvolution(evoLisa, startTime);
      }
    });
  };
  //=======================================
  stop.onclick = function() {
    evoLisa.stop();
  };
  //========================================
  reset.onclick = function() {
    evoLisa.stop();
    evoLisa = go();
    setTimeout(function() {
      start.click()
    }, 50);
    display.innerHTML = '';
  };
</script>
    
        <script src="js/index.js"></script>

    
    
    
  </body>
</html>
